INSERT INTO stock_ohlc_30min (symbol, datetime, date, time, open, high, low, close, volume, trade_count, vwap)
VALUES ('SPGI', '2025-05-22T13:30:00+00:00'::timestamptz, '2025-05-22'::date, '09:30:00'::time, 507.47, 510.99, 507.47, 509.715, 58060, 1788, 509.6641286250001), ('SPGI', '2025-05-22T14:00:00+00:00'::timestamptz, '2025-05-22'::date, '10:00:00'::time, 509.81, 510.235, 507.525, 507.83, 62784, 2368, 509.2522265714286), ('SPGI', '2025-05-22T14:30:00+00:00'::timestamptz, '2025-05-22'::date, '10:30:00'::time, 507.83, 508.26, 507.025, 508.09, 35938, 1796, 507.6268020869565), ('SPGI', '2025-05-22T15:00:00+00:00'::timestamptz, '2025-05-22'::date, '11:00:00'::time, 507.81, 509.42, 507.81, 509.15, 24092, 1137, 508.78178857894744), ('SPGI', '2025-05-22T15:30:00+00:00'::timestamptz, '2025-05-22'::date, '11:30:00'::time, 508.805, 509.965, 508.62, 509.03, 21221, 1042, 509.2941902857143), ('SPGI', '2025-05-22T16:00:00+00:00'::timestamptz, '2025-05-22'::date, '12:00:00'::time, 509.325, 510.605, 509.06, 509.625, 21806, 1045, 509.79588809523807), ('SPGI', '2025-05-22T16:30:00+00:00'::timestamptz, '2025-05-22'::date, '12:30:00'::time, 509.79, 510.3211, 508.785, 508.785, 16269, 1013, 509.74046), ('SPGI', '2025-05-22T17:00:00+00:00'::timestamptz, '2025-05-22'::date, '13:00:00'::time, 508.72, 510.73, 508.3401, 510.36, 21940, 961, 509.3224512631579), ('SPGI', '2025-05-22T17:30:00+00:00'::timestamptz, '2025-05-22'::date, '13:30:00'::time, 510.6, 511.55, 510.23, 511.4777, 29335, 1034, 510.9322066666667), ('SPGI', '2025-05-22T18:00:00+00:00'::timestamptz, '2025-05-22'::date, '14:00:00'::time, 511.58, 512.29, 511.58, 512.14, 38618, 1517, 511.95028931818183), ('SPGI', '2025-05-22T18:30:00+00:00'::timestamptz, '2025-05-22'::date, '14:30:00'::time, 512.145, 512.64, 511.65, 512.045, 24533, 1156, 511.9791968421053), ('SPGI', '2025-05-22T19:00:00+00:00'::timestamptz, '2025-05-22'::date, '15:00:00'::time, 512.27, 513.545, 511.9617, 513.545, 34981, 1673, 512.6623699130434), ('SPGI', '2025-05-22T19:30:00+00:00'::timestamptz, '2025-05-22'::date, '15:30:00'::time, 513.52, 514.17, 511.29, 511.74, 187290, 6224, 513.2936508333333), ('SPGI', '2025-05-22T20:00:00+00:00'::timestamptz, '2025-05-22'::date, '16:00:00'::time, 511.32, 511.32, 511.32, 511.32, 201123, 70, 511.32), ('SPGI', '2025-05-23T13:30:00+00:00'::timestamptz, '2025-05-23'::date, '09:30:00'::time, 507.11, 510.15, 506.65, 507.09, 63795, 2159, 507.7077650714286), ('SPGI', '2025-05-23T14:00:00+00:00'::timestamptz, '2025-05-23'::date, '10:00:00'::time, 507.33, 509.71, 507.13, 509.04, 64774, 2082, 508.6361315555555), ('SPGI', '2025-05-23T14:30:00+00:00'::timestamptz, '2025-05-23'::date, '10:30:00'::time, 509.42, 510.4, 508.705, 508.705, 32417, 1351, 509.6726101818182), ('SPGI', '2025-05-23T15:00:00+00:00'::timestamptz, '2025-05-23'::date, '11:00:00'::time, 508.49, 510.04, 508.33, 509.85, 130063, 2887, 509.0807886071429), ('SPGI', '2025-05-23T15:30:00+00:00'::timestamptz, '2025-05-23'::date, '11:30:00'::time, 509.86, 511.085, 509.81, 509.99, 132679, 2914, 510.324673), ('SPGI', '2025-05-23T16:00:00+00:00'::timestamptz, '2025-05-23'::date, '12:00:00'::time, 510.0, 510.9, 509.46, 510.72, 33639, 1366, 510.049256625), ('SPGI', '2025-05-23T16:30:00+00:00'::timestamptz, '2025-05-23'::date, '12:30:00'::time, 510.33, 511.77, 509.93, 511.095, 23535, 1054, 510.95908578260867), ('SPGI', '2025-05-23T17:00:00+00:00'::timestamptz, '2025-05-23'::date, '13:00:00'::time, 511.08, 511.8, 510.62, 511.66, 30469, 1061, 511.3524119047619), ('SPGI', '2025-05-23T17:30:00+00:00'::timestamptz, '2025-05-23'::date, '13:30:00'::time, 511.54, 512.25, 511.05, 511.72, 30895, 1245, 511.6055819230769), ('SPGI', '2025-05-23T18:00:00+00:00'::timestamptz, '2025-05-23'::date, '14:00:00'::time, 511.69, 512.74, 511.37, 511.7886, 37981, 1445, 512.0479040416667), ('SPGI', '2025-05-23T18:30:00+00:00'::timestamptz, '2025-05-23'::date, '14:30:00'::time, 511.95, 512.2, 511.52, 511.955, 33430, 1169, 511.83278700000005), ('SPGI', '2025-05-23T19:00:00+00:00'::timestamptz, '2025-05-23'::date, '15:00:00'::time, 511.74, 512.36, 510.8, 511.045, 41856, 1690, 511.6242952142857), ('SPGI', '2025-05-23T19:30:00+00:00'::timestamptz, '2025-05-23'::date, '15:30:00'::time, 511.39, 512.28, 509.41, 510.11, 206876, 6958, 511.1661935517241), ('SPGI', '2025-05-23T20:00:00+00:00'::timestamptz, '2025-05-23'::date, '16:00:00'::time, 510.02, 510.02, 510.02, 510.02, 291206, 69, 510.02), ('SPGI', '2025-05-27T13:30:00+00:00'::timestamptz, '2025-05-27'::date, '09:30:00'::time, 515.12, 516.07, 513.12, 514.055, 85295, 2864, 514.46859728), ('SPGI', '2025-05-27T14:00:00+00:00'::timestamptz, '2025-05-27'::date, '10:00:00'::time, 514.07, 515.36, 512.575, 514.7525, 58891, 2351, 513.9493520689656), ('SPGI', '2025-05-27T14:30:00+00:00'::timestamptz, '2025-05-27'::date, '10:30:00'::time, 514.99, 515.6, 514.24, 514.935, 36889, 1778, 515.004159), ('SPGI', '2025-05-27T15:00:00+00:00'::timestamptz, '2025-05-27'::date, '11:00:00'::time, 514.96, 515.8399, 514.7, 515.73, 40666, 1636, 515.1816057777778), ('SPGI', '2025-05-27T15:30:00+00:00'::timestamptz, '2025-05-27'::date, '11:30:00'::time, 515.38, 516.0, 515.3164, 515.9178, 21352, 1108, 515.658601590909), ('SPGI', '2025-05-27T16:00:00+00:00'::timestamptz, '2025-05-27'::date, '12:00:00'::time, 515.97, 516.5599, 515.91, 515.954, 19022, 1128, 516.21864375), ('SPGI', '2025-05-27T16:30:00+00:00'::timestamptz, '2025-05-27'::date, '12:30:00'::time, 516.4104, 517.37, 516.16, 517.15, 28283, 1340, 516.7986025789473), ('SPGI', '2025-05-27T17:00:00+00:00'::timestamptz, '2025-05-27'::date, '13:00:00'::time, 517.125, 517.5, 516.92, 517.2088, 16868, 986, 517.2570578), ('SPGI', '2025-05-27T17:30:00+00:00'::timestamptz, '2025-05-27'::date, '13:30:00'::time, 517.2, 517.92, 517.2, 517.78, 15063, 800, 517.5518250714285), ('SPGI', '2025-05-27T18:00:00+00:00'::timestamptz, '2025-05-27'::date, '14:00:00'::time, 518.22, 518.27, 517.43, 517.59, 17736, 935, 517.944036882353), ('SPGI', '2025-05-27T18:30:00+00:00'::timestamptz, '2025-05-27'::date, '14:30:00'::time, 517.43, 518.1097, 517.16, 517.16, 29553, 1499, 517.64751584), ('SPGI', '2025-05-27T19:00:00+00:00'::timestamptz, '2025-05-27'::date, '15:00:00'::time, 517.135, 517.36, 516.65, 517.05, 31269, 1686, 517.0667640869565), ('SPGI', '2025-05-27T19:30:00+00:00'::timestamptz, '2025-05-27'::date, '15:30:00'::time, 517.07, 517.54, 516.05, 516.94, 172670, 7227, 516.8995056206896), ('SPGI', '2025-05-27T20:00:00+00:00'::timestamptz, '2025-05-27'::date, '16:00:00'::time, 516.7, 516.7, 516.7, 516.7, 195127, 80, 516.7), ('SPGI', '2025-05-28T13:30:00+00:00'::timestamptz, '2025-05-28'::date, '09:30:00'::time, 514.65, 516.25, 514.06, 514.86, 76328, 2152, 515.1001355384616), ('SPGI', '2025-05-28T14:00:00+00:00'::timestamptz, '2025-05-28'::date, '10:00:00'::time, 515.18, 515.57, 513.545, 513.635, 55709, 2101, 514.3692839655173), ('SPGI', '2025-05-28T14:30:00+00:00'::timestamptz, '2025-05-28'::date, '10:30:00'::time, 513.845, 514.22, 512.31, 513.5965, 44963, 1885, 513.5931021538462), ('SPGI', '2025-05-28T15:00:00+00:00'::timestamptz, '2025-05-28'::date, '11:00:00'::time, 513.38, 514.04, 512.95, 513.0, 46350, 1791, 513.4689154230769), ('SPGI', '2025-05-28T15:30:00+00:00'::timestamptz, '2025-05-28'::date, '11:30:00'::time, 512.945, 514.1, 512.5, 513.6, 29342, 1558, 513.2530433636364), ('SPGI', '2025-05-28T16:00:00+00:00'::timestamptz, '2025-05-28'::date, '12:00:00'::time, 513.75, 514.46, 513.69, 514.015, 14746, 880, 514.14126335), ('SPGI', '2025-05-28T16:30:00+00:00'::timestamptz, '2025-05-28'::date, '12:30:00'::time, 514.27, 515.07, 514.03, 514.7, 17246, 1042, 514.64978685), ('SPGI', '2025-05-28T17:00:00+00:00'::timestamptz, '2025-05-28'::date, '13:00:00'::time, 514.51, 515.12, 514.3, 514.35, 14773, 755, 514.7274716875), ('SPGI', '2025-05-28T17:30:00+00:00'::timestamptz, '2025-05-28'::date, '13:30:00'::time, 514.3, 514.37, 513.49, 513.84, 17895, 886, 513.9790738888889), ('SPGI', '2025-05-28T18:00:00+00:00'::timestamptz, '2025-05-28'::date, '14:00:00'::time, 514.075, 514.69, 513.76, 514.36, 22297, 1350, 514.35234788), ('SPGI', '2025-05-28T18:30:00+00:00'::timestamptz, '2025-05-28'::date, '14:30:00'::time, 514.58, 514.61, 512.24, 513.37, 45749, 2254, 513.9004946923077), ('SPGI', '2025-05-28T19:00:00+00:00'::timestamptz, '2025-05-28'::date, '15:00:00'::time, 513.44, 513.92, 512.65, 512.89, 32653, 1552, 513.3894859130435), ('SPGI', '2025-05-28T19:30:00+00:00'::timestamptz, '2025-05-28'::date, '15:30:00'::time, 512.87, 512.87, 510.65, 511.62, 169369, 6444, 511.8871122857143), ('SPGI', '2025-05-28T20:00:00+00:00'::timestamptz, '2025-05-28'::date, '16:00:00'::time, 511.48, 511.48, 511.48, 511.48, 207683, 76, 511.48), ('SPGI', '2025-05-29T13:30:00+00:00'::timestamptz, '2025-05-29'::date, '09:30:00'::time, 513.03, 513.555, 509.83, 513.555, 72572, 2171, 511.4557760740741), ('SPGI', '2025-05-29T14:00:00+00:00'::timestamptz, '2025-05-29'::date, '10:00:00'::time, 513.54, 514.0999, 512.35, 513.28, 33629, 1795, 513.2398602962962), ('SPGI', '2025-05-29T14:30:00+00:00'::timestamptz, '2025-05-29'::date, '10:30:00'::time, 513.28, 513.62, 511.93, 512.72, 24231, 1226, 512.653800952381), ('SPGI', '2025-05-29T15:00:00+00:00'::timestamptz, '2025-05-29'::date, '11:00:00'::time, 512.9, 513.68, 512.325, 513.4, 25434, 1465, 512.9509352727273), ('SPGI', '2025-05-29T15:30:00+00:00'::timestamptz, '2025-05-29'::date, '11:30:00'::time, 513.4, 513.4, 510.235, 510.235, 27781, 1184, 512.0578842631579), ('SPGI', '2025-05-29T16:00:00+00:00'::timestamptz, '2025-05-29'::date, '12:00:00'::time, 509.71, 512.455, 509.46, 512.09, 21806, 1157, 511.3984363913043), ('SPGI', '2025-05-29T16:30:00+00:00'::timestamptz, '2025-05-29'::date, '12:30:00'::time, 512.4999, 513.39, 511.74, 513.27, 16240, 976, 512.5556741304348), ('SPGI', '2025-05-29T17:00:00+00:00'::timestamptz, '2025-05-29'::date, '13:00:00'::time, 513.3, 513.72, 512.9, 513.18, 21878, 1033, 513.2990434761905), ('SPGI', '2025-05-29T17:30:00+00:00'::timestamptz, '2025-05-29'::date, '13:30:00'::time, 513.065, 513.6, 512.73, 513.005, 31274, 1103, 513.18207435), ('SPGI', '2025-05-29T18:00:00+00:00'::timestamptz, '2025-05-29'::date, '14:00:00'::time, 513.16, 514.0, 512.47, 513.17, 29517, 1214, 513.3500057692307), ('SPGI', '2025-05-29T18:30:00+00:00'::timestamptz, '2025-05-29'::date, '14:30:00'::time, 513.23, 514.07, 513.0, 513.155, 33558, 1382, 513.6968807241379), ('SPGI', '2025-05-29T19:00:00+00:00'::timestamptz, '2025-05-29'::date, '15:00:00'::time, 513.0935, 514.0, 513.0, 513.8, 33641, 1586, 513.5021942799999), ('SPGI', '2025-05-29T19:30:00+00:00'::timestamptz, '2025-05-29'::date, '15:30:00'::time, 513.924, 515.16, 513.69, 514.01, 107088, 4332, 514.2991330714286), ('SPGI', '2025-05-29T20:00:00+00:00'::timestamptz, '2025-05-29'::date, '16:00:00'::time, 514.1, 514.1, 514.1, 514.1, 143504, 48, 514.1), ('SPGI', '2025-05-30T13:30:00+00:00'::timestamptz, '2025-05-30'::date, '09:30:00'::time, 514.1, 514.29, 508.46, 513.07, 50977, 1479, 513.2162374090909), ('SPGI', '2025-05-30T14:00:00+00:00'::timestamptz, '2025-05-30'::date, '10:00:00'::time, 513.4, 514.74, 513.4, 514.46, 40941, 1794, 514.2518823793104), ('SPGI', '2025-05-30T14:30:00+00:00'::timestamptz, '2025-05-30'::date, '10:30:00'::time, 514.28, 514.2963, 511.945, 511.945, 38804, 1446, 513.3304364583333), ('SPGI', '2025-05-30T15:00:00+00:00'::timestamptz, '2025-05-30'::date, '11:00:00'::time, 511.79, 513.98, 511.57, 513.81, 67517, 2183, 512.6084540769231), ('SPGI', '2025-05-30T15:30:00+00:00'::timestamptz, '2025-05-30'::date, '11:30:00'::time, 513.81, 514.56, 512.52, 512.795, 56084, 2032, 513.3605682), ('SPGI', '2025-05-30T16:00:00+00:00'::timestamptz, '2025-05-30'::date, '12:00:00'::time, 512.74, 513.39, 510.38, 510.69, 34352, 1748, 512.506270826087), ('SPGI', '2025-05-30T16:30:00+00:00'::timestamptz, '2025-05-30'::date, '12:30:00'::time, 510.505, 511.13, 509.44, 510.28, 36902, 1800, 510.22005807692307), ('SPGI', '2025-05-30T17:00:00+00:00'::timestamptz, '2025-05-30'::date, '13:00:00'::time, 510.15, 510.94, 510.07, 510.84, 36740, 1564, 510.59174848), ('SPGI', '2025-05-30T17:30:00+00:00'::timestamptz, '2025-05-30'::date, '13:30:00'::time, 511.03, 511.185, 510.19, 510.19, 29449, 1551, 510.71311152), ('SPGI', '2025-05-30T18:00:00+00:00'::timestamptz, '2025-05-30'::date, '14:00:00'::time, 510.425, 512.05, 510.315, 511.82, 115244, 2022, 511.25623596), ('SPGI', '2025-05-30T18:30:00+00:00'::timestamptz, '2025-05-30'::date, '14:30:00'::time, 511.945, 512.21, 511.21, 512.05, 40029, 1869, 511.73272836363634), ('SPGI', '2025-05-30T19:00:00+00:00'::timestamptz, '2025-05-30'::date, '15:00:00'::time, 512.06, 514.17, 512.06, 513.9771, 72957, 3283, 513.0418569333334), ('SPGI', '2025-05-30T19:30:00+00:00'::timestamptz, '2025-05-30'::date, '15:30:00'::time, 513.82, 514.7, 512.39, 512.91, 290149, 9184, 513.7093461333333), ('SPGI', '2025-05-30T20:00:00+00:00'::timestamptz, '2025-05-30'::date, '16:00:00'::time, 512.86, 512.866, 512.86, 512.861, 821126, 98, 512.860799), ('SPGI', '2025-06-02T13:30:00+00:00'::timestamptz, '2025-06-02'::date, '09:30:00'::time, 509.43, 510.856, 501.96, 503.72, 114266, 4296, 504.438761137931), ('SPGI', '2025-06-02T14:00:00+00:00'::timestamptz, '2025-06-02'::date, '10:00:00'::time, 502.65, 506.72, 502.415, 506.72, 72942, 2823, 504.84247122222223), ('SPGI', '2025-06-02T14:30:00+00:00'::timestamptz, '2025-06-02'::date, '10:30:00'::time, 506.73, 509.22, 506.71, 509.18, 28548, 1512, 508.07852515), ('SPGI', '2025-06-02T15:00:00+00:00'::timestamptz, '2025-06-02'::date, '11:00:00'::time, 509.18, 509.4087, 508.295, 508.52, 58084, 2151, 508.8649325), ('SPGI', '2025-06-02T15:30:00+00:00'::timestamptz, '2025-06-02'::date, '11:30:00'::time, 508.42, 510.1481, 508.4, 509.54, 21911, 1399, 509.06850545454546), ('SPGI', '2025-06-02T16:00:00+00:00'::timestamptz, '2025-06-02'::date, '12:00:00'::time, 509.79, 509.93, 508.525, 508.73, 20286, 1141, 509.2509837619048), ('SPGI', '2025-06-02T16:30:00+00:00'::timestamptz, '2025-06-02'::date, '12:30:00'::time, 508.91, 509.47, 508.645, 509.37, 29722, 1376, 509.06390280769233), ('SPGI', '2025-06-02T17:00:00+00:00'::timestamptz, '2025-06-02'::date, '13:00:00'::time, 509.48, 510.11, 508.4601, 508.835, 29584, 1188, 509.37269118181814), ('SPGI', '2025-06-02T17:30:00+00:00'::timestamptz, '2025-06-02'::date, '13:30:00'::time, 508.835, 510.71, 508.69, 510.575, 73902, 1629, 509.5209026), ('SPGI', '2025-06-02T18:00:00+00:00'::timestamptz, '2025-06-02'::date, '14:00:00'::time, 510.26, 512.4666, 510.1602, 511.94, 25725, 1446, 511.32172456), ('SPGI', '2025-06-02T18:30:00+00:00'::timestamptz, '2025-06-02'::date, '14:30:00'::time, 512.166, 512.38, 511.7, 512.38, 22953, 1111, 512.0359513157895), ('SPGI', '2025-06-02T19:00:00+00:00'::timestamptz, '2025-06-02'::date, '15:00:00'::time, 512.5, 512.96, 511.99, 512.7, 51362, 2285, 512.3630262307693), ('SPGI', '2025-06-02T19:30:00+00:00'::timestamptz, '2025-06-02'::date, '15:30:00'::time, 512.82, 513.74, 512.25, 513.7, 163487, 6343, 512.7794462333334), ('SPGI', '2025-06-02T20:00:00+00:00'::timestamptz, '2025-06-02'::date, '16:00:00'::time, 513.59, 513.6422, 513.59, 513.59, 137958, 61, 513.5917805), ('SPGI', '2025-06-03T13:30:00+00:00'::timestamptz, '2025-06-03'::date, '09:30:00'::time, 513.88, 513.88, 507.23, 508.44, 112364, 3236, 510.70644192857145), ('SPGI', '2025-06-03T14:00:00+00:00'::timestamptz, '2025-06-03'::date, '10:00:00'::time, 508.53, 509.5, 506.73, 508.465, 101048, 3564, 508.2794547931034)
ON CONFLICT (symbol, datetime) DO NOTHING;